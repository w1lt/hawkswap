{% extends 'base.html' %} {% block title %}Saved | HawkSwap{% endblock %} {%
block content %}
<h2>Inbox</h2>
<div class="chat-container">
  {% for chat in chats %}
  <a href="/chat/{{ chat.chat_id }}" class="chat-preview">
    <div>{{chat.seller_first_name}} | {{ chat.listing_name }}</div>
    <span class="recent-message">{{ chat.message_content }}</span> {% if
    chat.unread_count > 0 %}<span class="unread-message">
      {{ chat.unread_count }} Unread Message</span
    >{% endif %}

    <div class="chat-time">
      <script>
        var dateposted = new Date("{{ chat.sent_at }}");
        var currentdate = new Date();
        var diff = currentdate - dateposted;
        var days = Math.floor(diff / (1000 * 60 * 60 * 24));
        var hours = Math.floor(diff / (1000 * 60 * 60));
        if (days == 0) {
          if (hours == 0) {
            var minutes = Math.floor(diff / (1000 * 60));
            if (minutes == 0) {
              document.write("just now");
            } else {
              document.write(minutes + " minutes ago");
            }
          } else {
            document.write(hours + " hours ago");
          }
        } else {
          document.write(days + " days ago");
        }
      </script>
    </div>
  </a>
  {% endfor %}
</div>
<script>
  if ("{{ chats }}" == "[]") {
    document.write("No messages yet.");
  }
</script>
{% endblock %}
